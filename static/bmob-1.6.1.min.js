"use strict";var _slicedToArray=function(){function k(q,z){var A=[],B=!0,C=!1,D=void 0;try{for(var G,F=q[Symbol.iterator]();!(B=(G=F.next()).done)&&(A.push(G.value),!(z&&A.length===z));B=!0);}catch(H){C=!0,D=H}finally{try{!B&&F["return"]&&F["return"]()}finally{if(C)throw D}}return A}return function(q,z){if(Array.isArray(q))return q;if(Symbol.iterator in Object(q))return k(q,z);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function k(q,z){for(var B,A=0;A<z.length;A++)B=z[A],B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(q,B.key,B)}return function(q,z,A){return z&&k(q.prototype,z),A&&k(q,A),q}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(k){return typeof k}:function(k){return k&&"function"==typeof Symbol&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k};function _possibleConstructorReturn(k,q){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return q&&("object"==typeof q||"function"==typeof q)?q:k}function _inherits(k,q){if("function"!=typeof q&&null!==q)throw new TypeError("Super expression must either be null or a function, not "+typeof q);k.prototype=Object.create(q&&q.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),q&&(Object.setPrototypeOf?Object.setPrototypeOf(k,q):k.__proto__=q)}function _classCallCheck(k,q){if(!(k instanceof q))throw new TypeError("Cannot call a class as a function")}!function(k,q){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"==("undefined"==typeof module?"undefined":_typeof(module))?module.exports=q():"function"==typeof define&&define.amd?define([],q):"object"==("undefined"==typeof exports?"undefined":_typeof(exports))?exports.Bmob=q():k.Bmob=q()}("undefined"==typeof self?void 0:self,function(){return function(k){function q(A){if(z[A])return z[A].exports;var B=z[A]={i:A,l:!1,exports:{}};return k[A].call(B.exports,B,B.exports,q),B.l=!0,B.exports}var z={};return q.m=k,q.c=z,q.d=function(A,B,C){q.o(A,B)||Object.defineProperty(A,B,{configurable:!1,enumerable:!0,get:C})},q.n=function(A){var B=A&&A.__esModule?function(){return A.default}:function(){return A};return q.d(B,"a",B),B},q.o=function(A,B){return Object.prototype.hasOwnProperty.call(A,B)},q.p="",q(q.s=17)}([function(k,q,z){(function(A){var B=z(5),C=A.Bmob||{};C.utils=B,C._config=B.getConfig(),C.initialize=function(D,F,G){C._config.applicationId=D,C._config.applicationKey=F,C._config.applicationMasterKey=G},k.exports=C}).call(q,z(6))},function(k,q,z){"use strict";function A(I){return"[object Array]"===H.call(I)}function B(I){return null!==I&&"object"==("undefined"==typeof I?"undefined":_typeof(I))}function C(I){return"[object Function]"===H.call(I)}function D(I,J){if(null!==I&&void 0!==I)if("object"!=("undefined"==typeof I?"undefined":_typeof(I))&&(I=[I]),A(I))for(var K=0,L=I.length;K<L;K++)J.call(null,I[K],K,I);else for(var M in I)Object.prototype.hasOwnProperty.call(I,M)&&J.call(null,I[M],M,I)}var F=z(11),G=z(25),H=Object.prototype.toString;k.exports={isArray:A,isArrayBuffer:function isArrayBuffer(I){return"[object ArrayBuffer]"===H.call(I)},isBuffer:G,isFormData:function isFormData(I){return"undefined"!=typeof FormData&&I instanceof FormData},isArrayBufferView:function isArrayBufferView(I){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(I):I&&I.buffer&&I.buffer instanceof ArrayBuffer},isString:function isString(I){return"string"==typeof I},isNumber:function isNumber(I){return"number"==typeof I},isObject:B,isUndefined:function isUndefined(I){return void 0===I},isDate:function isDate(I){return"[object Date]"===H.call(I)},isFile:function isFile(I){return"[object File]"===H.call(I)},isBlob:function isBlob(I){return"[object Blob]"===H.call(I)},isFunction:C,isStream:function isStream(I){return B(I)&&C(I.pipe)},isURLSearchParams:function isURLSearchParams(I){return"undefined"!=typeof URLSearchParams&&I instanceof URLSearchParams},isStandardBrowserEnv:function isStandardBrowserEnv(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:D,merge:function I(){function J(N,O){K[O]="object"==_typeof(K[O])&&"object"==("undefined"==typeof N?"undefined":_typeof(N))?I(K[O],N):N}for(var K={},L=0,M=arguments.length;L<M;L++)D(arguments[L],J);return K},extend:function extend(I,J,K){return D(J,function(L,M){I[M]=K&&"function"==typeof L?F(L,K):L}),I},trim:function trim(I){return I.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(k){k.exports={isObject:function isObject(z){return"[object Object]"===Object.prototype.toString.call(z)},isNumber:function isNumber(z){return"[object Number]"===Object.prototype.toString.call(z)},isString:function isString(z){return"[object String]"===Object.prototype.toString.call(z)},isUndefined:function isUndefined(z){return"[object Undefined]"===Object.prototype.toString.call(z)},isBoolean:function isBoolean(z){return"[object Boolean]"===Object.prototype.toString.call(z)},isArray:function isArray(z){return"[object Array]"===Object.prototype.toString.call(z)},isFunction:function isFunction(z){return"[object Function]"===Object.prototype.toString.call(z)}}},function(k){k.exports=function(){function z(A,B){_classCallCheck(this,z);var C=new Error;return C.code=A,C.message=B?"Bmob.Error:{code:"+A+", message:"+B+"}":"Bmob.Error:{code:"+A+", message:"+this.errorMsg(A)+"}",C}return _createClass(z,[{key:"errorMsg",value:function errorMsg(A){return 415===A?"incorrect parameter type.":416===A?"Parameter is null.":417===A?"There is no upload content.":418===A?"Log in failure.":419===A?"Bmob.GeoPoint location error.":"unknown error"}}]),z}()},function(k,q,z){var A,B=z(5).getAppType();"h5"===B?A=z(10):"wx"===B?A=z(42):"hap"===B?A=z(43):"nodejs"===B&&(A=z(10)),k.exports=A},function(k,q,z){(function(A,B){var C;try{C=z(18)}catch(F){C=z(20)}var D=function(){return C};k.exports={getConfig:D,getAppType:function getAppType(){var F=D(),G;return G="undefined"==typeof wx?"undefined"==typeof window?3===F.type?"hap":A===B.process?"nodejs":"h5":"h5":"wx"}}}).call(q,z(7),z(6))},function(k){var z=function(){return this}();try{z=z||Function("return this")()||(0,eval)("this")}catch(A){"object"==("undefined"==typeof window?"undefined":_typeof(window))&&(z=window)}k.exports=z},function(k){function z(){throw new Error("setTimeout has not been defined")}function A(){throw new Error("clearTimeout has not been defined")}function B(O){if(H===setTimeout)return setTimeout(O,0);if((H===z||!H)&&setTimeout)return H=setTimeout,setTimeout(O,0);try{return H(O,0)}catch(P){try{return H.call(null,O,0)}catch(Q){return H.call(this,O,0)}}}function C(){M&&K&&(M=!1,K.length?L=K.concat(L):N=-1,L.length&&D())}function D(){if(!M){var O=B(C);M=!0;for(var P=L.length;P;){for(K=L,L=[];++N<P;)K&&K[N].run();N=-1,P=L.length}K=null,M=!1,function(Q){if(I===clearTimeout)return clearTimeout(Q);if((I===A||!I)&&clearTimeout)return I=clearTimeout,clearTimeout(Q);try{I(Q)}catch(R){try{return I.call(null,Q)}catch(U){return I.call(this,Q)}}}(O)}}function F(O,P){this.fun=O,this.array=P}function G(){}var H,I,J=k.exports={};!function(){try{H="function"==typeof setTimeout?setTimeout:z}catch(O){H=z}try{I="function"==typeof clearTimeout?clearTimeout:A}catch(O){I=A}}();var K,L=[],M=!1,N=-1;J.nextTick=function(O){var P=Array(arguments.length-1);if(1<arguments.length)for(var Q=1;Q<arguments.length;Q++)P[Q-1]=arguments[Q];L.push(new F(O,P)),1!==L.length||M||B(D)},F.prototype.run=function(){this.fun.apply(null,this.array)},J.title="browser",J.browser=!0,J.env={},J.argv=[],J.version="",J.versions={},J.on=G,J.addListener=G,J.once=G,J.off=G,J.removeListener=G,J.removeAllListeners=G,J.emit=G,J.prependListener=G,J.prependOnceListener=G,J.listeners=function(){return[]},J.binding=function(){throw new Error("process.binding is not supported")},J.cwd=function(){return"/"},J.chdir=function(){throw new Error("process.chdir is not supported")},J.umask=function(){return 0}},function(k,q,z){"use strict";(function(A){function B(I,J){!C.isUndefined(I)&&C.isUndefined(I["Content-Type"])&&(I["Content-Type"]=J)}var C=z(1),D=z(27),F={"Content-Type":"application/x-www-form-urlencoded"},G,H={adapter:("undefined"==typeof XMLHttpRequest?void 0!==A&&(G=z(12)):G=z(12),G),transformRequest:[function(I,J){return D(J,"Content-Type"),C.isFormData(I)||C.isArrayBuffer(I)||C.isBuffer(I)||C.isStream(I)||C.isFile(I)||C.isBlob(I)?I:C.isArrayBufferView(I)?I.buffer:C.isURLSearchParams(I)?(B(J,"application/x-www-form-urlencoded;charset=utf-8"),I.toString()):C.isObject(I)?(B(J,"application/json;charset=utf-8"),JSON.stringify(I)):I}],transformResponse:[function(I){if("string"==typeof I)try{I=JSON.parse(I)}catch(J){}return I}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function validateStatus(I){return 200<=I&&300>I}};H.headers={common:{Accept:"application/json, text/plain, */*"}},C.forEach(["delete","get","head"],function(I){H.headers[I]={}}),C.forEach(["post","put","patch"],function(I){H.headers[I]=C.merge(F)}),k.exports=H}).call(q,z(7))},function(K,k,q){function z(J,K,L){var M={},N={};N[K]=L,M[J]=N;var O=M;return Object.keys(this.queryData).length?F(this.queryData.$and)?this.queryData={$and:[this.queryData,O]}:this.queryData.$and.push(O):this.queryData=O,O}var L=q(0),A=q(4),_n=q(2),B=_n.isObject,C=_n.isString,D=_n.isNumber,F=_n.isUndefined,G=_n.isArray,H=q(3),I=q(16);K.exports=function(){function J(M){_classCallCheck(this,J),this.tableName=L._config.parameters.QUERY+"/"+M,this.className=M,this.init(),this.addArray={},this.setData={}}return _createClass(J,[{key:"init",value:function init(){this.queryData={},this.location={},this.andData={},this.orData={},this.stat={},this.limitNum=100,this.skipNum=0,this.includes="",this.queryReilation={},this.orders=null,this.keys=null}},{key:"get",value:function get(M){var aa=this;if(!C(M))throw new H(415);var $={},N={},O={},P={},Q=function(ba,ca){if(!C(ba)||!G(ca))throw new H(415);P[ba]={__op:"Add",objects:ca}},R=function(ba,ca){if(!C(ba)||!G(ca))throw new H(415);P[ba]={__op:"AddUnique",objects:ca}},U=function(ba,ca){if(!C(ba)||!G(ca))throw new H(415);P[ba]={__op:"Remove",objects:ca}},V=function(ba){var ca=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(!C(ba)||!D(ca))throw new H(415);N[ba]={__op:"Increment",amount:ca}},W=function(ba){if(!C(M))throw new H(415);O[ba]={__op:"Delete"}},X=function(ba,ca){if(!C(ba)||F(ca))throw new H(415);var da=ca.filename,ea=ca.cdn,fa=ca.url;$[ba]=F(da)||F(ea)||F(fa)?ca:{__type:"File",group:ea,filename:da,url:fa}},Y=function(){var ba=Object.assign(O,$,N,P);return"_User"===aa.className?new Promise(function(ca,da){A(aa.tableName+"/"+M,"put",ba).then(function(ea){var fa=aa.current(),ga=Object.assign(fa,ba);I.save("bmob",ga),ca(ea)}).catch(function(ea){da(ea)})}):A(aa.tableName+"/"+M,"put",ba)},Z={};return""!==this.includes&&(Z.include=this.includes),new Promise(function(ba,ca){A(aa.tableName+"/"+M,"get",Z).then(function(da){Object.defineProperty(da,"set",{value:X}),Object.defineProperty(da,"unset",{value:W}),Object.defineProperty(da,"save",{value:Y}),Object.defineProperty(da,"increment",{value:V}),Object.defineProperty(da,"add",{value:Q}),Object.defineProperty(da,"remove",{value:U}),Object.defineProperty(da,"addUnique",{value:R}),Object.defineProperty(da,"destroy",{value:function value(){return aa.destroy(M)}}),ba(da)}).catch(function(da){ca(da)})})}},{key:"destroy",value:function destroy(M){if(!C(M))throw new H(415);return A(this.tableName+"/"+M,"delete")}},{key:"set",value:function set(M,N){if(!C(M)||F(N))throw new H(415);var O=N.filename,P=N.cdn,Q=N.url;this.setData[M]=F(O)||F(P)||F(Q)?N:{__type:"File",group:P,filename:O,url:Q}}},{key:"add",value:function add(M,N){if(!C(M)||!G(N))throw new H(415);this.addArray[M]={__op:"Add",objects:N}}},{key:"addUnique",value:function addUnique(M,N){if(!C(M)||!G(N))throw new H(415);this.addArray[M]={__op:"AddUnique",objects:N}}},{key:"current",value:function current(){if("hap"!==L.type){var M=I.fetch("bmob");return"object"==("undefined"==typeof M?"undefined":_typeof(M))?M:JSON.parse(M)}return new Promise(function(N,O){return I.fetch("bmob").then(function(P){N(P)}).catch(function(P){O(P)})})}},{key:"updateStorage",value:function updateStorage(M){var N=this;if(!C(M))throw new H(415);return new Promise(function(O,P){var Q=N.current();if(!Q)throw new H(415);N.get(M).then(function(R){var U=Object.assign(Q,R);I.save("bmob",U),O(R)}).catch(function(R){console.log(R),P(R)})})}},{key:"save",value:function save(){var Q=this,M=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(!B(M))throw new H(415);var N=this.setData.id?"PUT":"POST",O=this.setData.id?this.setData.id:"";delete this.setData.id;var P=Object.assign(M,this.setData,this.addArray);return new Promise(function(R,U){A(Q.tableName+"/"+O,N,P).then(function(V){if(Q.addArray={},Q.setData={},"_User"===Q.className){var W=Q.current(),X=Object.assign(W,P);I.save("bmob",X)}R(V)}).catch(function(V){U(V)})})}},{key:"saveAll",value:function saveAll(M){var R=this;if(!G(M))throw new H(415);if(1>M.length)throw new H(416);var N,O,P="put",Q=[];M.map(function(W){return"/undefined"==(N="/"+W.objectId)&&(N="",P="post"),O={method:P,path:""+R.tableName+N,body:W.setData},Q.push(O),W});var V=L._config.parameters.BATCH;return A(V,"POST",{requests:Q})}},{key:"withinKilometers",value:function withinKilometers(M,_ref){var N=_ref.latitude,O=_ref.longitude,P=2<arguments.length&&void 0!==arguments[2]?arguments[2]:100,Q={};return Q[M]={$nearSphere:{__type:"GeoPoint",latitude:N,longitude:O},$maxDistanceInKilometers:P},this.location=Q,Q}},{key:"withinGeoBox",value:function withinGeoBox(M,_ref2,P){var N=_ref2.latitude,O=_ref2.longitude,Q={};return Q[M]={$within:{$box:[{__type:"GeoPoint",latitude:N,longitude:O},{__type:"GeoPoint",latitude:P.latitude,longitude:P.longitude}]}},this.location=Q,Q}},{key:"statTo",value:function statTo(M,N){if(!C(M))throw new H(415);return this.stat[M]=N,this.stat}},{key:"equalTo",value:function equalTo(M,N,O){if(!C(M))throw new H(415);var P=function(Q,R,U){var V={},W=null;switch(W="createdAt"===Q||"updateAt"===Q?{__type:"Date",iso:U}:U,R){case"==":case"===":V[Q]=W;break;case"!=":V[Q]={$ne:W};break;case"<":V[Q]={$lt:W};break;case"<=":V[Q]={$lte:W};break;case">":V[Q]={$gt:W};break;case">=":V[Q]={$gte:W};break;default:throw new H(415);}return V}(M,N,O);return Object.keys(this.queryData).length?F(this.queryData.$and)?this.queryData={$and:[this.queryData,P]}:this.queryData.$and.push(P):this.queryData=P,P}},{key:"containedIn",value:function containedIn(M,N){if(!C(M)||!G(N))throw new H(415);return z.call(this,M,"$in",N)}},{key:"notContainedIn",value:function notContainedIn(M,N){if(!C(M)||!G(N))throw new H(415);return z.call(this,M,"$nin",N)}},{key:"exists",value:function exists(M){if(!C(M))throw new H(415);return z.call(this,M,"$exists",!0)}},{key:"doesNotExist",value:function doesNotExist(M){if(!C(M))throw new H(415);return z.call(this,M,"$exists",!1)}},{key:"or",value:function or(){for(var N=arguments.length,M=Array(N),O=0;O<N;O++)M[O]=arguments[O];M.map(function(U){if(!B(U))throw new H(415)});var P=this.queryData.$and;if(console.log(P.length),!F(P)){for(var Q=0;Q<P.length;Q++)for(var R=0;R<M.length;R++)JSON.stringify(P[Q])===JSON.stringify(M[R])&&this.queryData.$and.splice(Q,1);P.length||delete this.queryData.$and}this.orData={$or:M}}},{key:"and",value:function and(){for(var N=arguments.length,M=Array(N),O=0;O<N;O++)M[O]=arguments[O];M.map(function(P){if(!B(P))throw new H(415)}),this.andData={$and:M}}},{key:"limit",value:function limit(M){if(!D(M))throw new H(415);1e3<M&&(M=1e3),this.limitNum=M}},{key:"skip",value:function skip(M){if(!D(M))throw new H(415);this.skipNum=M}},{key:"order",value:function order(){for(var N=arguments.length,M=Array(N),O=0;O<N;O++)M[O]=arguments[O];M.map(function(P){if(!C(P))throw new H(415)}),this.orders=M.join(",")}},{key:"include",value:function include(){for(var N=arguments.length,M=Array(N),O=0;O<N;O++)M[O]=arguments[O];M.map(function(P){if(!C(P))throw new H(415)}),this.includes=M.join(",")}},{key:"select",value:function select(){for(var N=arguments.length,M=Array(N),O=0;O<N;O++)M[O]=arguments[O];M.map(function(P){if(!C(P))throw new H(415)}),this.keys=M.join(",")}},{key:"field",value:function field(M,N){if(!C(M)||!C(N))throw new H(415);this.queryReilation.where={$relatedTo:{object:{__type:"Pointer",className:this.className,objectId:N},key:M}}}},{key:"relation",value:function relation(M){var N=this;if(!C(M))throw new H(415);return M="_User"===M?"users":"classes/"+M,new Promise(function(O,P){A("/1/"+M,"get",N.queryReilation).then(function(_ref3){var Q=_ref3.results;O(Q)}).catch(function(Q){P(Q)})})}},{key:"find",value:function find(){var R=this,M={},U={},N={};for(var O in Object.keys(this.queryData).length&&(U.where=this.queryData),Object.keys(this.location).length&&(U.where=Object.assign(this.location,this.queryData)),Object.keys(this.andData).length&&(U.where=Object.assign(this.andData,this.queryData)),Object.keys(this.orData).length&&(U.where=Object.assign(this.orData,this.queryData)),U.limit=this.limitNum,U.skip=this.skipNum,U.include=this.includes,U.order=this.orders,U.keys=this.keys,Object.keys(this.stat).length&&(U=this.stat),U)(U.hasOwnProperty(O)&&null===U[O]||0===U[O]||""===U[O])&&delete U[O];var P=function(V,W){if(!V||F(W))throw new H(415);M[V]=W},Q=function i(){var V=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"updata";if(console.log(V),1>N.length)throw new H(416);var W,X,Y="put",Z=[];N.map(function(ba){return"/undefined"==(W="/"+ba.objectId)&&(W="",Y="post"),X={method:Y,path:""+R.tableName+W,body:M},"delete"===V&&(X={method:"DELETE",path:""+R.tableName+W}),Z.push(X),ba});var aa=L._config.parameters.BATCH;return A(aa,"POST",{requests:Z})};return new Promise(function(V,W){A(""+R.tableName,"get",U).then(function(_ref4){var X=_ref4.results;R.init(),Object.defineProperty(X,"set",{value:P}),Object.defineProperty(X,"saveAll",{value:function value(){return Q()}}),Object.defineProperty(X,"destroyAll",{value:function value(){return Q("delete")}}),N=X,V(X)}).catch(function(X){W(X)})})}},{key:"count",value:function count(){var N=this,M={};return Object.keys(this.queryData).length&&(M.where=this.queryData),Object.keys(this.andData).length&&(M.where=Object.assign(this.andData,this.queryData)),Object.keys(this.orData).length&&(M.where=Object.assign(this.orData,this.queryData)),M.count=1,new Promise(function(O,P){A(""+N.tableName,"get",M).then(function(_ref5){var Q=_ref5.count;O(Q)}).catch(function(Q){P(Q)})})}}]),J}()},function(k,B,q){var z=q(23),A=q(0);k.exports=function(C){var D=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"get",F=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(G,H){void 0===A.User&&(A=q(0));var J=function(M){var N={"content-type":"application/json","X-Bmob-SDK-Type":"wechatApp","X-Bmob-Application-Id":M.applicationId,"X-Bmob-REST-API-Key":M.applicationKey};return M.applicationMasterKey&&(N["X-Bmob-Master-Key"]=M.applicationMasterKey),N}(A._config),I=A.User.current();I&&(J["X-Bmob-Session-Token"]=I.sessionToken);var K=z.create({baseURL:A._config.host,headers:J,validateStatus:function validateStatus(M){return 500>M}}),L={url:C,method:D};"get"===L.method?L.params=F:L.data=F,K(L).then(function(_ref6){var M=_ref6.data;(M.code&&M.error||M.error)&&H(M),G(M)}).catch(function(M){H(M)})})}},function(k){"use strict";k.exports=function(A,B){return function(){for(var C=Array(arguments.length),D=0;D<C.length;D++)C[D]=arguments[D];return A.apply(B,C)}}},function(k,q,z){"use strict";(function(A){var B=z(1),C=z(28),D=z(30),F=z(31),G=z(32),H=z(13),I="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||z(33);k.exports=function(J){return new Promise(function(K,L){var M=J.data,N=J.headers;B.isFormData(M)&&delete N["Content-Type"];var O=new XMLHttpRequest,P="onreadystatechange",Q=!1;if("test"===A.env.NODE_ENV||"undefined"==typeof window||!window.XDomainRequest||"withCredentials"in O||G(J.url)||(O=new window.XDomainRequest,P="onload",Q=!0,O.onprogress=function(){},O.ontimeout=function(){}),J.auth){var R=J.auth.username||"",U=J.auth.password||"";N.Authorization="Basic "+I(R+":"+U)}if(O.open(J.method.toUpperCase(),D(J.url,J.params,J.paramsSerializer),!0),O.timeout=J.timeout,O[P]=function(){if(O&&(4===O.readyState||Q)&&(0!==O.status||O.responseURL&&0===O.responseURL.indexOf("file:"))){var X="getAllResponseHeaders"in O?F(O.getAllResponseHeaders()):null,Y={data:J.responseType&&"text"!==J.responseType?O.response:O.responseText,status:1223===O.status?204:O.status,statusText:1223===O.status?"No Content":O.statusText,headers:X,config:J,request:O};C(K,L,Y),O=null}},O.onerror=function(){L(H("Network Error",J,null,O)),O=null},O.ontimeout=function(){L(H("timeout of "+J.timeout+"ms exceeded",J,"ECONNABORTED",O)),O=null},B.isStandardBrowserEnv()){var V=z(34),W=(J.withCredentials||G(J.url))&&J.xsrfCookieName?V.read(J.xsrfCookieName):void 0;W&&(N[J.xsrfHeaderName]=W)}if("setRequestHeader"in O&&B.forEach(N,function(X,Y){void 0===M&&"content-type"===Y.toLowerCase()?delete N[Y]:O.setRequestHeader(Y,X)}),J.withCredentials&&(O.withCredentials=!0),J.responseType)try{O.responseType=J.responseType}catch(X){if("json"!==J.responseType)throw X}"function"==typeof J.onDownloadProgress&&O.addEventListener("progress",J.onDownloadProgress),"function"==typeof J.onUploadProgress&&O.upload&&O.upload.addEventListener("progress",J.onUploadProgress),J.cancelToken&&J.cancelToken.promise.then(function(X){O&&(O.abort(),L(X),O=null)}),void 0===M&&(M=null),O.send(M)})}}).call(q,z(7))},function(k,q,z){"use strict";var A=z(29);k.exports=function(B,C,D,F,G){var H=new Error(B);return A(H,C,D,F,G)}},function(k){"use strict";k.exports=function(A){return A&&A.__CANCEL__}},function(k){"use strict";function A(B){this.message=B}A.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},A.prototype.__CANCEL__=!0,k.exports=A},function(k,q,z){var A,B=z(5).getAppType();"h5"===B?A=z(44):"wx"===B?A=z(45):"hap"===B?A=z(46):"nodejs"===B&&(A=z(47)),k.exports=A},function(k,q,z){(function(A){var B=z(0),C=z(21),D=z(22),F=z(9),G=z(48),H=z(49),I=z(50),J=z(51),_n3=z(52),K=_n3.generateCode,L=_n3.sendMessage,M=_n3.getAccessToken,N=_n3.sendWeAppMessage,O=_n3.refund,P=_n3.notifyMsg,Q=_n3.functions,R=_n3.timestamp,U=_n3.requestPasswordReset,V=_n3.resetPasswordBySmsCode,W=_n3.updateUserPassword,X=_n3.geoPoint,Y=_n3.checkMsg,Z=_n3.push,_n4=z(53),$=_n4.requestSmsCode,aa=_n4.verifySmsCode;B.GeoPoint=X,B.generateCode=K,B.sendMessage=L,B.getAccessToken=M,B.sendWeAppMessage=N,B.refund=O,B.checkMsg=Y,B.notifyMsg=P,B.requestSmsCode=$,B.verifySmsCode=aa,B.functions=Q,B.timestamp=R,B.requestPasswordReset=U,B.resetPasswordBySmsCode=V,B.updateUserPassword=W,B.push=Z,B.Pay=new I,B.User=new G,B.Socket=J,B.Query=function(ba){return new F(ba)},B.File=function(ba,ca){return new H(ba,ca)},B.request=z(4),B.type=B.utils.getAppType(),B.Pointer=function(ba){return new C(ba)},B.Relation=function(ba){return new D(ba)},"wx"===B.type?wx.Bmob=B:"h5"===B.type?window.Bmob=B:"hap"===B.type?A.Bmob=B:"nodejs"===B.type&&(A.Bmob=B),k.exports=B}).call(q,z(6))},function(k,q,z){var A="v"+z(19).version;k.exports={host:"https://api.bmobcloud.com",applicationId:"",applicationKey:"",applicationMasterKey:"",parameters:{GENERATECODE:"/1/wechatApp/qr/generatecode",GETACCESSTOKEN:"/1/wechatApp/getAccessToken",SENDWEAPPMESSAGE:"/1/wechatApp/SendWeAppMessage",NOTIFYMSG:"/1/wechatApp/notifyMsg",REFUND:"/1/pay/refund",REQUESTSMSCODE:"/1/requestSmsCode",VERIFYSMSCODE:"/1/verifySmsCode",FUNCTIONS:"/1/functions",REQUESTPASSWORDRESET:"/1/requestPasswordReset",RESETPASSWORDBYSMSCODE:"/1/resetPasswordBySmsCode",UPDATEUSERPASSWORD:"/1/updateUserPassword",PUSH:"/1/push",FILES:"/2/files",DELFILES:"/2/cdnBatchDelete",TIMESTAMP:"/1/timestamp",LOGIN:"/1/login",REGISTER:"/1/users",REQUEST_EMAIL_VERIFY:"/1/requestEmailVerify",USERS:"/1/users",PAY:"/1/pay",WECHAT_APP:"/1/wechatApp/",BATCH:"/1/batch",CHECK_MSG:"/1/wechatApp/checkMsg",QUERY:"/1/classes"},version:A,type:3}},function(k){k.exports={name:"hydrogen-js-sdk",version:"1.6.1",description:"Bmob SDK",main:"./src/lib/app.js",scripts:{test:"echo \"Error: no test specified\" && exit 1",build:"webpack --config config/prod.env.js",watch:"webpack --watch --config config/prod.env.js",dev:"webpack-dev-server --config config/dev.env.js"},repository:{type:"git",url:"git+https://github.com/bmob/hydrogen-js-sdk.git"},author:"Bmob",license:"ISC",bugs:{url:"https://github.com/bmob/hydrogen-js-sdk/issues"},homepage:"https://github.com/bmob/hydrogen-js-sdk#readme",dependencies:{axios:"^0.18.0","node.extend":"^2.0.0",webpack:"^3.12.0"},devDependencies:{"clean-webpack-plugin":"^0.1.19",eslint:"^4.19.1","eslint-config-standard":"^11.0.0","eslint-friendly-formatter":"^4.0.1","eslint-loader":"^2.0.0","eslint-plugin-import":"^2.12.0","eslint-plugin-node":"^6.0.1","eslint-plugin-promise":"^3.7.0","eslint-plugin-standard":"^3.1.0","html-webpack-plugin":"^2.30.1","uglifyjs-webpack-plugin":"^1.2.5","webpack-dev-server":"^2.11.2"},directories:{doc:"docs"},keywords:["Bmob"]}},function(k){k.exports={host:"https://api.bmobcloud.com",applicationId:"",applicationKey:"",parameters:{GENERATECODE:"/1/wechatApp/qr/generatecode",GETACCESSTOKEN:"/1/wechatApp/getAccessToken",SENDWEAPPMESSAGE:"/1/wechatApp/SendWeAppMessage",NOTIFYMSG:"/1/wechatApp/notifyMsg",REFUND:"/1/pay/refund",REQUESTSMSCODE:"/1/requestSmsCode",VERIFYSMSCODE:"/1/verifySmsCode",FUNCTIONS:"/1/functions",REQUESTPASSWORDRESET:"/1/requestPasswordReset",RESETPASSWORDBYSMSCODE:"/1/resetPasswordBySmsCode",UPDATEUSERPASSWORD:"/1/updateUserPassword",PUSH:"/1/push",FILES:"/2/files",DELFILES:"/2/cdnBatchDelete",TIMESTAMP:"/1/timestamp",LOGIN:"/1/login",REGISTER:"/1/users",REQUEST_EMAIL_VERIFY:"/1/requestEmailVerify",USERS:"/1/users",PAY:"/1/pay",WECHAT_APP:"/1/wechatApp/",BATCH:"/1/batch",CHECK_MSG:"/1/wechatApp/checkMsg",QUERY:"/1/classes"},version:1,type:1}},function(k,q,z){var _n5=z(2),A=_n5.isString,B=z(3);k.exports=function(){function C(D){if(_classCallCheck(this,C),!A(D))throw new B(415);this.tableName=D}return _createClass(C,[{key:"set",value:function set(D){if(!A(D))throw new B(415);return{__type:"Pointer",className:this.tableName,objectId:D}}}]),C}()},function(k,q,z){function A(F,G){var I=this;if(B(F))return{__op:G,objects:[{__type:"Pointer",className:this.tableName,objectId:F}]};if(C(F)){var H=[];return F.map(function(J){if(!B(J))throw new D(415);H.push({__type:"Pointer",className:I.tableName,objectId:J})}),{__op:G,objects:H}}throw new D(415)}var _n6=z(2),B=_n6.isString,C=_n6.isArray,D=z(3);k.exports=function(){function F(G){if(_classCallCheck(this,F),!B(G))throw new D(415);this.tableName=G}return _createClass(F,[{key:"add",value:function add(G){return A.call(this,G,"AddRelation")}},{key:"remove",value:function remove(G){return A.call(this,G,"RemoveRelation")}}]),F}()},function(k,q,z){k.exports=z(24)},function(k,q,z){"use strict";function A(H){var I=new D(H),J=C(D.prototype.request,I);return B.extend(J,D.prototype,I),B.extend(J,I),J}var B=z(1),C=z(11),D=z(26),F=z(8),G=A(F);G.Axios=D,G.create=function(H){return A(B.merge(F,H))},G.Cancel=z(15),G.CancelToken=z(40),G.isCancel=z(14),G.all=function(H){return Promise.all(H)},G.spread=z(41),k.exports=G,k.exports.default=G},function(k){function z(A){return!!A.constructor&&"function"==typeof A.constructor.isBuffer&&A.constructor.isBuffer(A)}k.exports=function(A){return null!=A&&(z(A)||function(B){return"function"==typeof B.readFloatLE&&"function"==typeof B.slice&&z(B.slice(0,0))}(A)||!!A._isBuffer)}},function(k,q,z){"use strict";function A(G){this.defaults=G,this.interceptors={request:new D,response:new D}}var B=z(8),C=z(1),D=z(35),F=z(36);A.prototype.request=function(G){"string"==typeof G&&(G=C.merge({url:arguments[0]},arguments[1])),(G=C.merge(B,{method:"get"},this.defaults,G)).method=G.method.toLowerCase();var H=[F,void 0],I=Promise.resolve(G);for(this.interceptors.request.forEach(function(J){H.unshift(J.fulfilled,J.rejected)}),this.interceptors.response.forEach(function(J){H.push(J.fulfilled,J.rejected)});H.length;)I=I.then(H.shift(),H.shift());return I},C.forEach(["delete","get","head","options"],function(G){A.prototype[G]=function(H,I){return this.request(C.merge(I||{},{method:G,url:H}))}}),C.forEach(["post","put","patch"],function(G){A.prototype[G]=function(H,I,J){return this.request(C.merge(J||{},{method:G,url:H,data:I}))}}),k.exports=A},function(k,q,z){"use strict";var A=z(1);k.exports=function(B,C){A.forEach(B,function(D,F){F!==C&&F.toUpperCase()===C.toUpperCase()&&(B[C]=D,delete B[F])})}},function(k,q,z){"use strict";var A=z(13);k.exports=function(B,C,D){var F=D.config.validateStatus;D.status&&F&&!F(D.status)?C(A("Request failed with status code "+D.status,D.config,null,D.request,D)):B(D)}},function(k){"use strict";k.exports=function(A,B,C,D,F){return A.config=B,C&&(A.code=C),A.request=D,A.response=F,A}},function(k,q,z){"use strict";function A(C){return encodeURIComponent(C).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var B=z(1);k.exports=function(C,D,F){if(!D)return C;var G;if(F)G=F(D);else if(B.isURLSearchParams(D))G=D.toString();else{var H=[];B.forEach(D,function(I,J){null!==I&&void 0!==I&&(B.isArray(I)?J+="[]":I=[I],B.forEach(I,function(K){B.isDate(K)?K=K.toISOString():B.isObject(K)&&(K=JSON.stringify(K)),H.push(A(J)+"="+A(K))}))}),G=H.join("&")}return G&&(C+=(-1===C.indexOf("?")?"?":"&")+G),C}},function(k,q,z){"use strict";var A=z(1),B=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];k.exports=function(C){var D,F,G,H={};return C?(A.forEach(C.split("\n"),function(I){if(G=I.indexOf(":"),D=A.trim(I.substr(0,G)).toLowerCase(),F=A.trim(I.substr(G+1)),D){if(H[D]&&0<=B.indexOf(D))return;H[D]="set-cookie"===D?(H[D]?H[D]:[]).concat([F]):H[D]?H[D]+", "+F:F}}),H):H}},function(k,q,z){"use strict";var A=z(1);k.exports=A.isStandardBrowserEnv()?function(){function B(G){var H=G;return D&&(F.setAttribute("href",H),H=F.href),F.setAttribute("href",H),{href:F.href,protocol:F.protocol?F.protocol.replace(/:$/,""):"",host:F.host,search:F.search?F.search.replace(/^\?/,""):"",hash:F.hash?F.hash.replace(/^#/,""):"",hostname:F.hostname,port:F.port,pathname:"/"===F.pathname.charAt(0)?F.pathname:"/"+F.pathname}}var C,D=/(msie|trident)/i.test(navigator.userAgent),F=document.createElement("a");return C=B(window.location.href),function(G){var H=A.isString(G)?B(G):G;return H.protocol===C.protocol&&H.host===C.host}}():function(){return!0}},function(k){"use strict";function A(){this.message="String contains an invalid character"}A.prototype=new Error,A.prototype.code=5,A.prototype.name="InvalidCharacterError",k.exports=function(C){for(var D,F,G=C+"",H="",I=0,J="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";G.charAt(0|I)||(J="=",I%1);H+=J.charAt(63&D>>8-8*(I%1))){if(255<(F=G.charCodeAt(I+=.75)))throw new A;D=D<<8|F}return H}},function(k,q,z){"use strict";var A=z(1);k.exports=A.isStandardBrowserEnv()?{write:function write(B,C,D,F,G,H){var I=[];I.push(B+"="+encodeURIComponent(C)),A.isNumber(D)&&I.push("expires="+new Date(D).toGMTString()),A.isString(F)&&I.push("path="+F),A.isString(G)&&I.push("domain="+G),!0===H&&I.push("secure"),document.cookie=I.join("; ")},read:function read(B){var C=document.cookie.match(new RegExp("(^|;\\s*)("+B+")=([^;]*)"));return C?decodeURIComponent(C[3]):null},remove:function remove(B){this.write(B,"",Date.now()-864e5)}}:{write:function write(){},read:function read(){return null},remove:function remove(){}}},function(k,q,z){"use strict";function A(){this.handlers=[]}var B=z(1);A.prototype.use=function(C,D){return this.handlers.push({fulfilled:C,rejected:D}),this.handlers.length-1},A.prototype.eject=function(C){this.handlers[C]&&(this.handlers[C]=null)},A.prototype.forEach=function(C){B.forEach(this.handlers,function(D){null!==D&&C(D)})},k.exports=A},function(k,q,z){"use strict";function A(I){I.cancelToken&&I.cancelToken.throwIfRequested()}var B=z(1),C=z(37),D=z(14),F=z(8),G=z(38),H=z(39);k.exports=function(I){return A(I),I.baseURL&&!G(I.url)&&(I.url=H(I.baseURL,I.url)),I.headers=I.headers||{},I.data=C(I.data,I.headers,I.transformRequest),I.headers=B.merge(I.headers.common||{},I.headers[I.method]||{},I.headers||{}),B.forEach(["delete","get","head","post","put","patch","common"],function(J){delete I.headers[J]}),(I.adapter||F.adapter)(I).then(function(J){return A(I),J.data=C(J.data,J.headers,I.transformResponse),J},function(J){return D(J)||(A(I),J&&J.response&&(J.response.data=C(J.response.data,J.response.headers,I.transformResponse))),Promise.reject(J)})}},function(k,q,z){"use strict";var A=z(1);k.exports=function(B,C,D){return A.forEach(D,function(F){B=F(B,C)}),B}},function(k){"use strict";k.exports=function(A){return /^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(A)}},function(k){"use strict";k.exports=function(A,B){return B?A.replace(/\/+$/,"")+"/"+B.replace(/^\/+/,""):A}},function(k,q,z){"use strict";function A(C){if("function"!=typeof C)throw new TypeError("executor must be a function.");var D;this.promise=new Promise(function(G){D=G});var F=this;C(function(G){F.reason||(F.reason=new B(G),D(F.reason))})}var B=z(15);A.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},A.source=function(){var C;return{token:new A(function(D){C=D}),cancel:C}},k.exports=A},function(k){"use strict";k.exports=function(A){return function(B){return A.apply(null,B)}}},function(k,A,q){var z=q(0);k.exports=function(B){var C=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"get",D=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(F,G){var I=function(J){var K={"content-type":"application/json","X-Bmob-SDK-Type":"wechatApp","X-Bmob-Application-Id":J.applicationId,"X-Bmob-REST-API-Key":J.applicationKey};return J.applicationMasterKey&&(K["X-Bmob-Master-Key"]=J.applicationMasterKey),K}(z._config);void 0===z.User&&(z=q(0));var H=z.User.current();H&&(I["X-Bmob-Session-Token"]=H.sessionToken),wx.request({url:z._config.host+B,method:C,data:D,header:I,success:function success(J){(J.data.code&&J.data.error||J.data.error)&&G(J.data),F(J.data)},fail:function fail(J){console.log(J),G(J)}})})}},function(k,A,q){var z=q(0);k.exports=function(B){var C=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"get",D=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(F,G){var I=function(J){var K={"content-type":"application/json","X-Bmob-SDK-Type":"wechatApp","X-Bmob-Application-Id":J.applicationId,"X-Bmob-REST-API-Key":J.applicationKey};return J.applicationMasterKey&&(K["X-Bmob-Master-Key"]=J.applicationMasterKey),K}(z._config);void 0===z.User&&(z=q(0));var H=z.User.current();H&&(I["X-Bmob-Session-Token"]=H.sessionToken),"xxrequire('@system.fetch')xx".fetch({url:z._config.host+B,header:I,method:C,data:D,success:function success(J){var K=JSON.parse(J.data);K.code&&G(K),F(K)},fail:function fail(J,K){console.log("handling fail, code = "+K),G(J)}})})}},function(k,q,z){var _n8=z(2),A=_n8.isString,B=void 0;B="undefined"==typeof cc?localStorage:cc.sys.localStorage,console.log(B);k.exports={save:function save(D,F){if(!A(D)||!F)throw new Error(415);B.setItem(D,JSON.stringify(F))},fetch:function fetch(D){if(!A(D))throw new Error(415);return JSON.parse(B.getItem(D))||null},remove:function remove(D){if(!A(D))throw new Error(415);B.removeItem(D)},clear:function clear(){B.clear()}}},function(k,q,z){var _n9=z(2),A=_n9.isString,B=_n9.isObject;k.exports={save:function save(D,F){if(!A(D)||!F)throw new Error(415);return F=B(F)?JSON.stringify(F):F,wx.setStorageSync(D,F)},fetch:function fetch(D){if(!A(D))throw new Error(415);return wx.getStorageSync(D)||null},remove:function remove(D){if(!A(D))throw new Error(415);return wx.removeStorageSync(D)},clear:function clear(){return wx.clearStorageSync()}}},function(k,q,z){var _n10=z(2),A=_n10.isString,B="xxrequire('@system.storage')xx";k.exports={save:function save(D,F){if(!A(D)||!F)throw new Error(415);B.set({key:D,value:JSON.stringify(F),success:function success(G){return console.log("handling success"),G},fail:function fail(G,H){console.log("handling fail, code = "+H)}})},fetch:function fetch(D){if(!A(D))throw new Error(415);return new Promise(function(F,G){return B.get({key:D,success:function success(H){F(H||null)},fail:function fail(H,I){console.log("handling fail, code = "+I),G(H)}})})},remove:function remove(D){if(!A(D))throw new Error(415);B.delete({key:D,success:function success(){console.log("handling success")},fail:function fail(F,G){console.log("handling fail, code = "+G)}})},clear:function clear(){B.clear({success:function success(){console.log("handling success")},fail:function fail(D,F){console.log("handling fail, code = "+F)}})}}},function(k){k.exports={save:function save(){},fetch:function fetch(){return null},remove:function remove(){},clear:function clear(){}}},function(k,K,q){var z=q(4),A=q(16),B=q(9),C=q(0),D=q(3),_n11=q(2),F=_n11.isObject,G=_n11.isString,H=_n11.isNumber;k.exports=function(I){function J(){return _classCallCheck(this,J),_possibleConstructorReturn(this,(J.__proto__||Object.getPrototypeOf(J)).call(this,"_User"))}return _inherits(J,I),_createClass(J,[{key:"set",value:function set(L){var M=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";G(L)&&(this.setData[L]=M)}},{key:"requestEmailVerify",value:function requestEmailVerify(L){if(!G(L))throw new D(415);this.setData=Object.assign({},{email:L}),console.log(this.setData);var M=C._config.parameters.REQUEST_EMAIL_VERIFY;return z(M,"post",this.setData)}},{key:"register",value:function register(L){if(!F(L))throw new D(415);this.setData=Object.assign(this.setData,L),console.log(this.setData);var M=C._config.parameters.REGISTER;return z(M,"post",this.setData)}},{key:"login",value:function login(L,M){var O=this;if(!G(L)||!G(M))throw new D(415);this.setData=Object.assign({},{username:L,password:M});var N=C._config.parameters.LOGIN;return new Promise(function(P,Q){z(N,"get",O.setData).then(function(R){A.save("bmob",R),P(R)}).catch(function(R){console.log("\u767B\u9646\u5931\u8D25"),Q(R)})})}},{key:"users",value:function users(){var L=C._config.parameters.USERS;return z(L,"get")}},{key:"signOrLoginByMobilePhone",value:function signOrLoginByMobilePhone(L,M){if(!H(L)||!H(M))throw new D(415);this.setData=Object.assign({},{mobilePhoneNumber:L,smsCode:M});var N=C._config.parameters.LOGIN;return z(N,"get",this.setData)}},{key:"requestOpenId",value:function requestOpenId(L){var M=C._config.parameters.WECHAT_APP;return z(M+L,"POST",{})}},{key:"linkWith",value:function linkWith(L){var N=C._config.parameters.USERS;return z(N,"POST",{authData:L})}},{key:"loginWithWeapp",value:function loginWithWeapp(L){var M=this;return new Promise(function(N,O){M.requestOpenId(L).then(function(P){var R=M.linkWith({weapp:P});N(R)}).catch(function(P){O(P)})})}},{key:"upInfo",value:function upInfo(L){var M=this;return new Promise(function(N,O){var P=L.nickName,Q=L.avatarUrl,R=M.current();if(!R)throw new D(415);var U=A.fetch("openid");M.get(R.objectId).then(function(V){V.set("nickName",P),V.set("userPic",Q),V.set("openid",U),V.save().then(function(W){N(W)}).catch(function(W){console.log(W),O(W)})}).catch(function(V){console.log(V),O(V)})})}},{key:"auth",value:function auth(){var L=this;return new Promise(function(M,N){var O=function(){wx.login({success:function success(P){L.loginWithWeapp(P.code).then(function(Q){if(Q.error)throw new D(415);var R=Q.authData.weapp.openid;A.save("openid",R),A.save("bmob",Q),M(Q)},function(Q){N(Q)})}})};wx.checkSession({success:function success(){var P=L.current();null===P&&N("\u767B\u9646\u9519\u8BEF\uFF0C\u8BF7\u5728Bmob\u540E\u53F0\u586B\u5199\u5C0F\u7A0B\u5E8FAppSecret\u3002"),M(P),O()},fail:function fail(){O()}})})}}]),J}(B)},function(k,q,z){var G=z(4),H=z(0),A=z(3),B=z(5),_n12=z(2),D=_n12.isString,F=_n12.isArray,I=[];k.exports=function(){function J(K,L){if(_classCallCheck(this,J),K&&L){if(!D(K))throw new A(415);I.push({name:K,route:H._config.parameters.FILES+"/"+K,data:L})}}return _createClass(J,[{key:"save",value:function save(){if(!I.length)throw new A(417);var K,L=B.getAppType();return"h5"===L||"nodejs"===L?K=new Promise(function(M,N){var O=[],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var Q,R,P=I[Symbol.iterator]();!(_iteratorNormalCompletion=(Q=P.next()).done);_iteratorNormalCompletion=!0)R=Q.value,G(R.route,"post",R.data).then(function(U){O.push(U),O.length===I.length&&(I=[],M(O),N(O))}).catch(function(U){O.push(U)})}catch(U){_didIteratorError=!0,_iteratorError=U}finally{try{!_iteratorNormalCompletion&&P.return&&P.return()}finally{if(_didIteratorError)throw _iteratorError}}}):"wx"===L?K=new Promise(function(M,N){void 0===H.User&&(H=z(0));var P="bmob",O=H.User.current();O&&(P=O.sessionToken);var Q=[],R={_ApplicationId:H._config.applicationId,_RestKey:H._config.applicationKey,_SessionToken:P},U=Object.assign({_ContentType:"text/plain",mime_type:"text/plain",category:"wechatApp",_ClientVersion:"js3.6.1",_InstallationId:"bmob"},R),_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var W,X,V=I[Symbol.iterator]();!(_iteratorNormalCompletion2=(W=V.next()).done);_iteratorNormalCompletion2=!0)X=W.value,wx.uploadFile({url:H._config.host+X.route,filePath:X.data,name:"file",header:{"X-Bmob-SDK-Type":"wechatApp"},formData:U,success:function success(Y){var Z=Y.data;Q.push(Z),Q.length===I.length&&(I=[],M(Q),N(Q))},fail:function fail(Y){Q.push(Y)}})}catch(Y){_didIteratorError2=!0,_iteratorError2=Y}finally{try{!_iteratorNormalCompletion2&&V.return&&V.return()}finally{if(_didIteratorError2)throw _iteratorError2}}}):"hap"===L&&(K=new Promise(function(M,N){void 0===H.User&&(H=z(0));var O=H.User.current(),P=[],Q={_ApplicationId:H._config.applicationId,_RestKey:H._config.applicationKey,_SessionToken:O.sessionToken},R=Object.assign({_ContentType:"text/plain",mime_type:"text/plain",category:"wechatApp",_ClientVersion:"js3.6.1",_InstallationId:"bmob"},Q),_iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var V,W,U=I[Symbol.iterator]();!(_iteratorNormalCompletion3=(V=U.next()).done);_iteratorNormalCompletion3=!0)W=V.value,"xxrequire('@system.request')xx".upload({url:H._config.host+W.route,files:[{uri:W.data,name:"file",filename:W.name}],header:{"X-Bmob-SDK-Type":"wechatApp"},data:R,success:function success(X){console.log("handling success"+P);var Y=X.data;P.push(Y),P.length===I.length&&(I=[],M(P),N(P))},fail:function fail(X,Y){console.log("handling fail, code = "+Y)}})}catch(X){_didIteratorError3=!0,_iteratorError3=X}finally{try{!_iteratorNormalCompletion3&&U.return&&U.return()}finally{if(_didIteratorError3)throw _iteratorError3}}})),K}},{key:"destroy",value:function destroy(K){if(D(K))return G(H._config.parameters.FILES+"/upyun/"+K.split(".com/")[1],"delete");if(F(K)){var L=[];return K.map(function(M){L.push(M.split(".com/")[1])}),G(H._config.parameters.DELFILES,"post",{upyun:L})}throw new A(415)}}]),J}()},function(k,q,z){var A=z(4),B=z(0),C=z(3);k.exports=function(){function D(){_classCallCheck(this,D)}return _createClass(D,[{key:"weApp",value:function weApp(F,G,H){var I=wx.getStorageSync("openid");if(!(F&&G&&H&&I))throw new C(416);var K=B._config.parameters.PAY;return A(K,"post",{order_price:F,product_name:G,body:H,open_id:I,pay_type:4})}}]),D}()},function(k,q,z){var A=z(0),B=z(3),C={setup:function setup(D){var F=[];Object.assign(D,{on:function on(G,H){"function"==typeof H&&F.push([G,H])},emit:function emit(G){for(var I=arguments.length,H=Array(1<I?I-1:0),J=1;J<I;J++)H[J-1]=arguments[J];F.forEach(function(_ref7){var _ref8=_slicedToArray(_ref7,2),K=_ref8[0],L=_ref8[1];return G===K&&L.apply(void 0,H)})},removeAllListeners:function removeAllListeners(){F=[]}})}};k.exports=function(){function D(){if(_classCallCheck(this,D),!A._config.applicationId)throw new B(415);this.config={host:"wss.bmobcloud.com"},C.setup(this.emitter={}),this.applicationId=A._config.applicationId,this.initialize()}return _createClass(D,[{key:"handshake",value:function handshake(){var F="https://"+this.config.host+"/socket.io/1/?t="+new Date().getTime(),G=JSON.stringify({});return new Promise(function(H){wx.request({method:"GET",url:F,data:G,header:{"content-type":"text/plain"},success:function success(J){return J.data&&J.data.statusCode?H("request error",e):200===J.statusCode?H(function(K){return K instanceof B?void(self.connecting=!1,self.onError(K.message)):K.split(":")[0]}(J.data)):H("request error",e)},fail:function fail(J){return H("request error",J)}})})}},{key:"initialize",value:function initialize(){var F=this;return this.handshake().then(function(G){try{F.connect("wss://"+F.config.host+"/socket.io/1/websocket/"+G,{})}catch(H){throw console.error({connectError:H}),H}}),this.on("close",function(){console.log("\u8FDE\u63A5\u5DF2\u4E2D\u65AD")}),new Promise(function(){F.on("server_pub",function(I){switch(I.action){case"updateTable":F.onUpdateTable(I.tableName,I.data);break;case"updateRow":F.onUpdateRow(I.tableName,I.objectId,I.data);break;case"deleteTable":F.onDeleteTable(I.tableName,I.data);break;case"deleteRow":F.onDeleteRow(I.tableName,I.objectId,I.data);}}),F.on("client_send_data",function(){F.onInitListen()})})}},{key:"onInitListen",value:function onInitListen(){}},{key:"connect",value:function connect(F,G){var J=this,H=Object.keys(G).map(function(K){return K+"="+encodeURIComponent(G[K])}).join("&"),I=-1<F.indexOf("?")?"&":"?";return F=[F,H].join(I),new Promise(function(K,L){wx.onSocketOpen(K),wx.onSocketError(L),wx.onSocketMessage(function(M){try{var Q=M.data;if("2:::"===Q.slice(0,4)&&J.emit(!1,!0),null===(Q=Q.slice(4))||""===Q)return;var _t4=function P(U){var _JSON$parse=JSON.parse(U),V=_JSON$parse.name,W=_JSON$parse.args;return{name:V,args:W}}(Q),N=_t4.name,O=_t4.args,R=null==O?"":JSON.parse(O[0]);J.emitter.emit(N,R)}catch(U){console.log("Handle packet failed: "+M.data,U)}}),wx.onSocketClose(function(){return J.emitter.emit("close")}),wx.connectSocket({url:F,header:G})})}},{key:"on",value:function on(F,G){this.emitter.on(F,G)}},{key:"emit",value:function emit(F,G){G=void 0===G?"5:::":"2:::",F=F?JSON.stringify(F):"",wx.sendSocketMessage({data:G+F})}},{key:"emitData",value:function emitData(F,G){return{name:F,args:[G=JSON.stringify(G)]}}},{key:"updateTable",value:function updateTable(F){var G={appKey:this.applicationId,tableName:F,objectId:"",action:"updateTable"};G=this.emitData("client_sub",G),this.emit(G)}},{key:"unsubUpdateTable",value:function unsubUpdateTable(F){var G={appKey:this.applicationId,tableName:F,objectId:"",action:"unsub_updateTable"};G=this.emitData("client_sub",G),this.emit(G)}},{key:"updateRow",value:function updateRow(F,G){var H={appKey:this.applicationId,tableName:F,objectId:G,action:"updateRow"};H=this.emitData("client_sub",H),this.emit(H)}},{key:"unsubUpdateRow",value:function unsubUpdateRow(F,G){var H={appKey:this.applicationId,tableName:F,objectId:G,action:"unsub_updateRow"};H=this.emitData("client_sub",H),this.emit(H)}},{key:"deleteTable",value:function deleteTable(F){var G={appKey:this.applicationId,tableName:F,objectId:"",action:"deleteTable"};G=this.emitData("client_sub",G),this.emit(G)}},{key:"unsubDeleteTable",value:function unsubDeleteTable(F){var G={appKey:this.applicationId,tableName:F,objectId:"",action:"unsub_deleteTable"};G=this.emitData("client_sub",G),this.emit(G)}},{key:"deleteRow",value:function deleteRow(F,G){var H={appKey:this.applicationId,tableName:F,objectId:G,action:"deleteRow"};H=this.emitData("client_sub",H),this.emit(H)}},{key:"unsubDeleteRow",value:function unsubDeleteRow(F,G){var H={appKey:this.applicationId,tableName:F,objectId:G,action:"unsub_deleteRow"};H=this.emitData("client_sub",H),this.emit(H)}},{key:"onUpdateTable",value:function onUpdateTable(){}},{key:"onUpdateRow",value:function onUpdateRow(){}},{key:"onDeleteTable",value:function onDeleteTable(){}},{key:"onDeleteRow",value:function onDeleteRow(){}}]),D}()},function(k,q,z){var A=z(4),B=z(0),C=z(3),_n16=z(2),D=_n16.isObject,F=_n16.isString;k.exports={generateCode:function generateCode(G){if(!D(G))throw new C(415);var H=B._config.parameters.GENERATECODE;return A(H,"post",G)},sendMessage:function sendMessage(){return 1},getAccessToken:function getAccessToken(){var H=B._config.parameters.GETACCESSTOKEN;return A(H,"get")},sendWeAppMessage:function sendWeAppMessage(G){if(!D(G))throw new C(415);var H=B._config.parameters.SENDWEAPPMESSAGE;return A(H,"post",G)},refund:function refund(G){if(!D(G))throw new C(415);var H=B._config.parameters.REFUND;return A(H,"post",G)},notifyMsg:function notifyMsg(G){if(!D(G))throw new C(415);var H=B._config.parameters.NOTIFYMSG;return A(H,"post",G)},functions:function functions(G,H){if(H||(H={}),!F(G))throw new C(415);var I=B._config.parameters.FUNCTIONS+"/"+G;return A(I,"post",H)},timestamp:function timestamp(){var G=B._config.parameters.TIMESTAMP;return A(G,"get")},requestPasswordReset:function requestPasswordReset(G){if(!D(G))throw new C(415);var H=B._config.parameters.REQUESTPASSWORDRESET;return A(H,"post",G)},resetPasswordBySmsCode:function resetPasswordBySmsCode(G,H){if(!F(G))throw new C(415);var I=B._config.parameters.RESETPASSWORDBYSMSCODE+"/"+G;return A(I,"put",H)},updateUserPassword:function updateUserPassword(G,H){if(!D(H)||!F(G))throw new C(415);var I=B._config.parameters.UPDATEUSERPASSWORD+"/"+G;return A(I,"put",H)},geoPoint:function geoPoint(_ref9){var G=_ref9.latitude,H=_ref9.longitude;return function(I,J){if(-90>I)throw new C(419);if(90<I)throw new C(419);if(-180>J)throw new C(419);if(180<J)throw new C(419)}(G,H),{__type:"GeoPoint",latitude:G,longitude:H}},checkMsg:function checkMsg(G){if(!F(G))throw new C(415);var H=""+B._config.parameters.CHECK_MSG;return A(H,"post",{content:G})},push:function push(G){if(!D(G))throw new C(415);var H=B._config.parameters.PUSH;return A(H,"post",G)}}},function(k,q,z){var A=z(4),B=z(0),C=z(3),_n17=z(2),D=_n17.isObject,F=_n17.isString;k.exports={requestSmsCode:function requestSmsCode(G){if(!D(G))throw new C(415);var I=B._config.parameters.REQUESTSMSCODE;return A(I,"post",G)},verifySmsCode:function verifySmsCode(G,H){if(!F(G))throw new C(415);if(!D(H))throw new C(415);var J=B._config.parameters.VERIFYSMSCODE+"/"+G;return A(J,"post",H)}}}])});
